import{_ as p,r as o,o as e,c,a as n,b as l,F as u,e as s,d as a}from"./app.dc2cb511.js";const k={},i=s(`<h1 id="\u6570\u636E\u83B7\u53D6" tabindex="-1"><a class="header-anchor" href="#\u6570\u636E\u83B7\u53D6" aria-hidden="true">#</a> \u6570\u636E\u83B7\u53D6</h1><h2 id="\u57FA\u7840" tabindex="-1"><a class="header-anchor" href="#\u57FA\u7840" aria-hidden="true">#</a> \u57FA\u7840</h2><p><code>nuxt3</code> \u4E2D\u5185\u7F6E\u4E86\u4EE5\u4E0B\u56DB\u79CD\u8BF7\u6C42\u7684\u65B9\u6CD5</p><ul><li>useFetch</li><li>useLazyFetch</li><li>useAsyncData</li><li>useLazyAsyncData</li></ul><div class="language-html ext-html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token comment">// \u53C2\u6570\u4E00\u662F key</span>
<span class="token comment">// \u53C2\u6570\u4E8C\u662F\u8BF7\u6C42 handler\uFF0C\u8FD4\u56DE\u8BF7\u6C42\u7684 promise</span>
<span class="token comment">// \u89E3\u6784\u51FA\u6765\u7684 data \u4E3A\u6570\u636E\uFF0Cerror \u4E3A\u9519\u8BEF\u4FE1\u606F</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> error <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">useAsyncData</span><span class="token punctuation">(</span><span class="token string">&#39;count&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;mock&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>data: {{ data }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>error: {{ error }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>\u5185\u7F6E\u7684 <code>$fetch</code> \u53EF\u4EE5\u76F4\u63A5\u8FDB\u884C\u8BF7\u6C42</p><div class="language-html ext-html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> error <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">useAsyncData</span><span class="token punctuation">(</span><span class="token string">&#39;count&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">$fetch</span><span class="token punctuation">(</span><span class="token string">&#39;http://...&#39;</span><span class="token punctuation">)</span> <span class="token comment">// \u8BF7\u6C42\u5730\u5740</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>\u5F53\u7136\u4F60\u53EF\u4EE5\u7528\u66F4\u7B80\u6D01\u7684 <code>useFetch</code>\uFF0C\u5B83\u4F1A\u5728\u5185\u90E8\u81EA\u52A8\u751F\u6210 <code>key</code>\u3002</p><div class="language-html ext-html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> error <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">useFetch</span><span class="token punctuation">(</span><span class="token string">&#39;http://...&#39;</span><span class="token punctuation">)</span> <span class="token comment">// \u4F60\u7684\u8BF7\u6C42\u5730\u5740</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><code>useFetch</code> \u4F1A\u5728\u5185\u90E8\u81EA\u52A8\u4F7F\u7528 <code>$fetch</code> \u4F5C\u4E3A\u8BF7\u6C42\u65B9\u6CD5\uFF0C\u6240\u4EE5\u6CA1\u6709 <code>useAsyncData</code> \u7075\u6D3B\u3002</p><br><h3 id="lazy" tabindex="-1"><a class="header-anchor" href="#lazy" aria-hidden="true">#</a> lazy</h3><p><code>useFetch</code> \u548C <code>useAsyncData</code> \u4F1A\u963B\u585E\u5BFC\u822A\u7684\u8DF3\u8F6C\u3002</p><p>\u4F8B\u5982\uFF0C<code>index</code> \u9875\u9762\u8DF3\u8F6C\u5230 <code>home</code> \u9875\u9762</p><div class="language-html ext-html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>NuxtLink</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/home<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> to home<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>NuxtLink</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>\u800C <code>home</code> \u9875\u9762\u6709 <code>useFetch</code> \u8BF7\u6C42</p><div class="language-html ext-html"><pre class="language-html"><code><span class="token comment">&lt;!-- pages/home.vue --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token comment">// \u4EE5\u4E0B\u8BF7\u6C42\u5C06\u4F1A\u963B\u585E\u5BFC\u822A\u7684\u8DF3\u8F6C</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">useFetch</span><span class="token punctuation">(</span><span class="token string">&#39;http://localhost:4000&#39;</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>{{ data }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>\u800C\u4F7F\u7528\u5BF9\u5E94\u7684 <code>lazy</code> \u6A21\u5F0F\uFF0C<code>useLazyFetch</code> \u6216 <code>useLazyAsyncData</code> \u53EF\u4EE5\u8BA9\u5BFC\u822A\u8DF3\u8F6C\u4E0D\u88AB\u963B\u585E</p><div class="language-html ext-html"><pre class="language-html"><code><span class="token comment">&lt;!-- pages/home.vue --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token comment">// \u4F7F\u7528 useFetch \u7684 lazy \u6A21\u5F0F\uFF0C\u4E0D\u4F1A\u963B\u585E\u5BFC\u822A\u8DF3\u8F6C</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">useLazyFetch</span><span class="token punctuation">(</span><span class="token string">&#39;http://localhost:4000&#39;</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>{{ data }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><br><br><h2 id="\u6CE8\u610F" tabindex="-1"><a class="header-anchor" href="#\u6CE8\u610F" aria-hidden="true">#</a> \u6CE8\u610F</h2><p>\u7531\u4E8E <code>nuxt3</code> \u9ED8\u8BA4\u662F\u5168 <code>SSR</code> \u7684\u6E32\u67D3\u6A21\u5F0F\uFF0C\u6240\u4EE5\u76F8\u540C\u7684\u4E1A\u52A1\u4EE3\u7801\u4F1A\u5728 <code>node</code> \u548C\u6D4F\u89C8\u5668\u90FD\u8DD1\u4E00\u904D\u3002</p><p>\u8FD9\u610F\u5473\u7740\u5927\u591A\u6570 <strong>\u4EC5\u652F\u6301\u6D4F\u89C8\u5668\u7684\u8BF7\u6C42\u5E93</strong> \u53EF\u80FD\u9700\u8981\u88AB\u8FEB\u5728\u7279\u5B9A\u751F\u547D\u5468\u671F\u8282\u70B9\u4E2D\u8FD0\u884C\u3002</p>`,24),r=a("\u5177\u4F53\u53EF\u89C1 \u{1F449} "),g={href:"https://staging-cn.vuejs.org/guide/scaling-up/ssr.html#access-to-platform-specific-apis",target:"_blank",rel:"noopener noreferrer"},d=a("SSR/\u8BBF\u95EE\u5E73\u53F0\u7279\u6709 API"),h=a("\u3002"),m=s(`<p>\u56E0\u4E3A <code>axios</code> \u517C\u5BB9 <code>node</code> \u548C\u6D4F\u89C8\u5668\u53CC\u7AEF\u7684\uFF0C\u6240\u4EE5\u4F60\u80FD\u591F\u4F7F\u7528\u5B83\u8FDB\u884C\u8BF7\u6C42\u3002</p><div class="language-html ext-html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;http://...&#39;</span><span class="token punctuation">)</span> <span class="token comment">// \u4F60\u7684\u8BF7\u6C42\u5730\u5740</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>\u4E0D\u8FC7\u8FD8\u662F\u63A8\u8350\u4F60\u4F7F\u7528\u5185\u7F6E\u8BF7\u6C42\u65B9\u6CD5\u3002</p>`,3);function v(y,f){const t=o("ExternalLinkIcon");return e(),c(u,null,[i,n("p",null,[r,n("a",g,[d,l(t)]),h]),m],64)}var x=p(k,[["render",v],["__file","data-fetch.html.vue"]]);export{x as default};
